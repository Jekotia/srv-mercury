version: "3.2"
services:

  discord-irc:
    image: jekotia/discord-irc
    container_name: discord-irc
    restart: unless-stopped
    volumes:
    - ${_DISCORDIRC_DATA}:/data

  mailer:
    container_name: "mailer"
    image: "tecnativa/postfix-relay"
    restart: "always"
    environment:
    - "MAIL_RELAY_HOST=smtp.gmail.com"
    - "MAIL_RELAY_PORT=587"
    - "MAIL_RELAY_USER=mercury@jekotia.net"
    - "MAIL_RELAY_PASS=${SMTP_PASSWORD}"
    volumes:
    - ${_MAILER_DATA}/queue:/var/spool/postfix
    networks:
      mailer:

  weechat:
    image: jekotia/weechat
    container_name: weechat
    restart: unless-stopped
    volumes:
    - ${_WEECHAT_DATA}:/data
    networks:
    - proxy
    stdin_open: true
    tty: true
    labels:
      caddy_1.address: mercury.jekotia.net
      caddy_1.proxy: "/weechat weechat:9001"
      caddy_1.proxy.websocket: ""

networks:
  proxy:
    external:
      name: core_proxy
  mailer:
